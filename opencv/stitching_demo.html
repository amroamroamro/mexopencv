<!DOCTYPE html>
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <!--This HTML was auto-generated from published MATLAB code.-->
      <title>Simple rotation model images stitcher</title>
      <meta name="generator" content="MATLAB 9.2">
      <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
      <meta name="DC.date" content="2017-11-27">
      <meta name="DC.source" content="stitching_demo.m">
      <link rel="stylesheet" type="text/css" href="publish_custom.css">
   </head>
   <body>
      <div class="content">
         <h1 id="1">Simple rotation model images stitcher</h1>
         <!--introduction-->
         <p>A basic example on image stitching.</p>
         <p>In this demo, we show how to use the high-level stitching API provided by <tt>cv.Stitcher</tt>, and we learn how to use preconfigured stitcher configurations to stitch images using different camera models.
         </p>
         <p>Sources:</p>
         <div>
            <ul>
               <li><a href="https://docs.opencv.org/3.3.1/d8/d19/tutorial_stitcher.html">https://docs.opencv.org/3.3.1/d8/d19/tutorial_stitcher.html</a></li>
               <li><a href="https://github.com/opencv/opencv/blob/3.3.1/samples/cpp/stitching.cpp">https://github.com/opencv/opencv/blob/3.3.1/samples/cpp/stitching.cpp</a></li>
            </ul>
         </div>
         <!--/introduction-->
         <h2 id="toc">Contents</h2>
         <div>
            <ul>
               <li><a href="#2">Input images (two or more)</a></li>
               <li><a href="#3">Options</a></li>
               <li><a href="#5">Stitch</a></li>
               <li><a href="#6">Panorama result</a></li>
            </ul>
         </div>
         <h2 id="2">Input images (two or more)</h2><pre class="codeinput">imgs = {
    imread(fullfile(mexopencv.root(),<span class="string">'test'</span>,<span class="string">'b1.jpg'</span>)), <span class="keyword">...</span>
    imread(fullfile(mexopencv.root(),<span class="string">'test'</span>,<span class="string">'b2.jpg'</span>))
};
<span class="keyword">for</span> i=1:numel(imgs)
    subplot(1,numel(imgs),i), imshow(imgs{i})
<span class="keyword">end</span></pre><img src="stitching_demo_01.png"><h2 id="3">Options</h2><pre class="codeinput"><span class="comment">% Try to use GPU. The default value is false.</span>
<span class="comment">% All default values are for CPU mode.</span>
try_use_gpu = false;

<span class="comment">% Determines configuration of stitcher. The default is 'Panorama' mode</span>
<span class="comment">% suitable for creating photo panoramas. Option 'Scans' is suitable for</span>
<span class="comment">% stitching materials under affine transformation, such as scans.</span>
smode = <span class="string">'Panorama'</span>;

<span class="comment">% Internally create three chunks of each image to increase stitching success</span>
divide_images = false;</pre><pre class="codeinput"><span class="keyword">if</span> divide_images
    <span class="keyword">for</span> i=1:numel(imgs)
        sz = size(imgs{i});
        imgs{i} = {
            cv.Rect.crop(imgs{i}, [0       0 sz(2)/2 sz(1)]), <span class="keyword">...</span>
            cv.Rect.crop(imgs{i}, [sz(2)/3 0 sz(2)/2 sz(1)]), <span class="keyword">...</span>
            cv.Rect.crop(imgs{i}, [sz(2)/2 0 sz(2)/2 sz(1)])
        };
    <span class="keyword">end</span>
    imgs = [imgs{:}];
<span class="keyword">end</span></pre><h2 id="5">Stitch</h2><pre class="codeinput">stitcher = cv.Stitcher(<span class="string">'Mode'</span>,smode, <span class="string">'TryUseGPU'</span>,try_use_gpu);
tic
pano = stitcher.stitch(imgs);
toc</pre><pre class="codeoutput">Elapsed time is 1.139193 seconds.
</pre><h2 id="6">Panorama result</h2><pre class="codeinput">figure, imshow(pano)</pre><img src="stitching_demo_02.png"><div class="footer">
            <p><a href="https://www.mathworks.com/products/matlab.html">Published with MATLAB&reg; R2017a</a></p>
         </div>
      </div>
      <!--
##### SOURCE BEGIN #####
%% Simple rotation model images stitcher
% A basic example on image stitching.
%
% In this demo, we show how to use the high-level stitching API provided by
% |cv.Stitcher|, and we learn how to use preconfigured stitcher configurations
% to stitch images using different camera models.
%
% Sources:
%
% * <https://docs.opencv.org/3.3.1/d8/d19/tutorial_stitcher.html>
% * <https://github.com/opencv/opencv/blob/3.3.1/samples/cpp/stitching.cpp>
%

%% Input images (two or more)
imgs = {
    imread(fullfile(mexopencv.root(),'test','b1.jpg')), ...
    imread(fullfile(mexopencv.root(),'test','b2.jpg'))
};
for i=1:numel(imgs)
    subplot(1,numel(imgs),i), imshow(imgs{i})
end

%% Options

% Try to use GPU. The default value is false.
% All default values are for CPU mode.
try_use_gpu = false;

% Determines configuration of stitcher. The default is 'Panorama' mode
% suitable for creating photo panoramas. Option 'Scans' is suitable for
% stitching materials under affine transformation, such as scans.
smode = 'Panorama';

% Internally create three chunks of each image to increase stitching success
divide_images = false;

%%
if divide_images
    for i=1:numel(imgs)
        sz = size(imgs{i});
        imgs{i} = {
            cv.Rect.crop(imgs{i}, [0       0 sz(2)/2 sz(1)]), ...
            cv.Rect.crop(imgs{i}, [sz(2)/3 0 sz(2)/2 sz(1)]), ...
            cv.Rect.crop(imgs{i}, [sz(2)/2 0 sz(2)/2 sz(1)])
        };
    end
    imgs = [imgs{:}];
end

%% Stitch
stitcher = cv.Stitcher('Mode',smode, 'TryUseGPU',try_use_gpu);
tic
pano = stitcher.stitch(imgs);
toc

%% Panorama result
figure, imshow(pano)

##### SOURCE END #####
-->
   </body>
</html>