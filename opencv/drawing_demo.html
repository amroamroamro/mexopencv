<!DOCTYPE html>
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <!--This HTML was auto-generated from published MATLAB code.-->
      <title>Demonstration of drawing functions</title>
      <meta name="generator" content="MATLAB 9.2">
      <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
      <meta name="DC.date" content="2017-11-27">
      <meta name="DC.source" content="drawing_demo.m">
      <link rel="stylesheet" type="text/css" href="publish_custom.css">
   </head>
   <body>
      <div class="content">
         <h1 id="1">Demonstration of drawing functions</h1>
         <!--introduction-->
         <p>This program demonstrates OpenCV drawing and text output functions.</p>
         <p>Sources:</p>
         <div>
            <ul>
               <li><a href="https://github.com/opencv/opencv/blob/3.2.0/samples/cpp/drawing.cpp">https://github.com/opencv/opencv/blob/3.2.0/samples/cpp/drawing.cpp</a></li>
               <li><a href="https://docs.opencv.org/3.2.0/df/d61/tutorial_random_generator_and_text.html">https://docs.opencv.org/3.2.0/df/d61/tutorial_random_generator_and_text.html</a></li>
               <li><a href="https://docs.opencv.org/3.2.0/dc/da5/tutorial_py_drawing_functions.html">https://docs.opencv.org/3.2.0/dc/da5/tutorial_py_drawing_functions.html</a></li>
               <li><a href="https://github.com/opencv/opencv/blob/3.2.0/samples/cpp/tutorial_code/core/Matrix/Drawing_2.cpp">https://github.com/opencv/opencv/blob/3.2.0/samples/cpp/tutorial_code/core/Matrix/Drawing_2.cpp</a></li>
            </ul>
         </div>
         <!--/introduction-->
         <h2 id="toc">Contents</h2>
         <div>
            <ul>
               <li><a href="#2">Options</a></li>
               <li><a href="#3">Lines</a></li>
               <li><a href="#4">Rectangles</a></li>
               <li><a href="#5">Ellipses</a></li>
               <li><a href="#6">Polygons</a></li>
               <li><a href="#7">Filled Polygons</a></li>
               <li><a href="#8">Circles</a></li>
               <li><a href="#9">Text</a></li>
               <li><a href="#10">Text Animation</a></li>
            </ul>
         </div>
         <h2 id="2">Options</h2><pre class="codeinput">DELAY = 5e-3;                  <span class="comment">% pause delay (sec)</span>
NUMBER = 100;                  <span class="comment">% number of repeats</span>
lineType = {<span class="string">'LineType'</span>,<span class="string">'AA'</span>};  <span class="comment">% change to 8 to see non-antialiased graphics</span>
W = 800; H = 600;              <span class="comment">% width/height of output image</span>
img = zeros(H,W,3,<span class="string">'uint8'</span>);

<span class="comment">% rng</span>
xlims = fix([-W/2 W*3/2]);
ylims = fix([-H/2 H*3/2]);
clr = @() randi([0 255], [1 3], <span class="string">'uint8'</span>);
markers = <span class="string">'+x*ds^v'</span>;
marker = @() markers(randi([1 numel(markers)]));

<span class="comment">% prepare plot</span>
hImg = imshow(img);</pre><img src="drawing_demo_01.png"><h2 id="3">Lines</h2><pre class="codeinput"><span class="keyword">for</span> i=1:NUMBER*2
    pt1 = [randi(xlims) randi(ylims)];
    pt2 = [randi(xlims) randi(ylims)];
    thick = randi([1 10]);

    <span class="keyword">if</span> rand &lt; 0.5
        img = cv.line(img, pt1, pt2, <span class="keyword">...</span>
            <span class="string">'Color'</span>,clr(), <span class="string">'Thickness'</span>,thick, lineType{:});
    <span class="keyword">else</span>
        img = cv.arrowedLine(img, pt1, pt2, <span class="keyword">...</span>
            <span class="string">'Color'</span>,clr(), <span class="string">'Thickness'</span>,thick, lineType{:});
    <span class="keyword">end</span>

    set(hImg, <span class="string">'CData'</span>,img);
    pause(DELAY);
<span class="keyword">end</span></pre><img src="drawing_demo_02.png"><h2 id="4">Rectangles</h2><pre class="codeinput"><span class="keyword">for</span> i=1:NUMBER*2
    pt1 = [randi(xlims) randi(ylims)];
    pt2 = [randi(xlims) randi(ylims)];
    thick = max(randi([-3 10]), -1);

    <span class="keyword">if</span> rand &lt; 0.5
        img = cv.rectangle(img, pt1, pt2, <span class="keyword">...</span>
            <span class="string">'Color'</span>,clr(), <span class="string">'Thickness'</span>,thick, lineType{:});
    <span class="keyword">else</span>
        img = cv.drawMarker(img, pt1, <span class="keyword">...</span>
            <span class="string">'Color'</span>,clr(), <span class="string">'MarkerType'</span>,marker(), <span class="string">'MarkerSize'</span>,randi([30 80]));
    <span class="keyword">end</span>

    set(hImg, <span class="string">'CData'</span>,img);
    pause(DELAY);
<span class="keyword">end</span></pre><img src="drawing_demo_03.png"><h2 id="5">Ellipses</h2><pre class="codeinput"><span class="keyword">for</span> i=1:NUMBER
    center = [randi(xlims) randi(ylims)];
    ax = randi([0 200], [1 2]);
    a = randi([0 180]);
    thick = randi([-1 9]);

    img = cv.ellipse(img, center, ax, <span class="keyword">...</span>
        <span class="string">'Angle'</span>,a, <span class="string">'StartAngle'</span>,a-100, <span class="string">'EndAngle'</span>,a+200, <span class="keyword">...</span>
        <span class="string">'Color'</span>,clr(), <span class="string">'Thickness'</span>,thick, lineType{:});

    set(hImg, <span class="string">'CData'</span>,img);
    pause(DELAY);
<span class="keyword">end</span></pre><img src="drawing_demo_04.png"><h2 id="6">Polygons</h2><pre class="codeinput"><span class="keyword">for</span> i=1:NUMBER
    pts = arrayfun(@(~) [randi(xlims, [3 1]) randi(ylims, [3 1])], 1:2, <span class="keyword">...</span>
        <span class="string">'Uniform'</span>,false);
    thick = randi([1 10]);

    img = cv.polylines(img, pts, <span class="keyword">...</span>
        <span class="string">'Closed'</span>,true, <span class="string">'Color'</span>,clr(), <span class="string">'Thickness'</span>,thick, lineType{:});

    set(hImg, <span class="string">'CData'</span>,img);
    pause(DELAY);
<span class="keyword">end</span></pre><img src="drawing_demo_05.png"><h2 id="7">Filled Polygons</h2><pre class="codeinput"><span class="keyword">for</span> i=1:NUMBER
    pts = arrayfun(@(~) [randi(xlims, [3 1]) randi(ylims, [3 1])], 1:2, <span class="keyword">...</span>
        <span class="string">'Uniform'</span>,false);

    img = cv.fillPoly(img, pts, <span class="keyword">...</span>
        <span class="string">'Color'</span>,clr(), lineType{:});

    set(hImg, <span class="string">'CData'</span>,img);
    pause(DELAY);
<span class="keyword">end</span></pre><img src="drawing_demo_06.png"><h2 id="8">Circles</h2><pre class="codeinput"><span class="keyword">for</span> i=1:NUMBER
    center = [randi(xlims) randi(ylims)];
    radius = randi([0 300]);
    thick = randi([-1 9]);

    img = cv.circle(img, center, radius, <span class="keyword">...</span>
        <span class="string">'Color'</span>,clr(), <span class="string">'Thickness'</span>,thick, lineType{:});

    set(hImg, <span class="string">'CData'</span>,img);
    pause(DELAY);
<span class="keyword">end</span></pre><img src="drawing_demo_07.png"><h2 id="9">Text</h2><pre class="codeinput">str = <span class="string">'Testing text rendering'</span>;
fonts = strcat(<span class="string">'Hershey'</span>, {<span class="string">'Simplex'</span>, <span class="string">'Plain'</span>, <span class="string">'Duplex'</span>, <span class="string">'Complex'</span>, <span class="keyword">...</span>
    <span class="string">'Triplex'</span>, <span class="string">'ComplexSmall'</span>, <span class="string">'ScriptSimplex'</span>, <span class="string">'ScriptComplex'</span>});
<span class="keyword">for</span> i=1:NUMBER
    pt = [randi(xlims) randi(ylims)];
    font = randi([1 numel(fonts)]);
    scale = randi([0 100])*0.05 + 0.1;
    thick = randi([1 10]);

    img = cv.putText(img, str, pt, <span class="keyword">...</span>
        <span class="string">'FontFace'</span>,fonts{font}, <span class="string">'FontScale'</span>,scale, <span class="keyword">...</span>
        <span class="string">'Color'</span>,clr(), <span class="string">'Thickness'</span>,thick, lineType{:});

    set(hImg, <span class="string">'CData'</span>,img);
    pause(DELAY);
<span class="keyword">end</span></pre><img src="drawing_demo_08.png"><h2 id="10">Text Animation</h2><pre class="codeinput">str = <span class="string">'OpenCV forever!'</span>;
opts = {<span class="string">'FontFace'</span>,<span class="string">'HersheyComplex'</span>, <span class="string">'FontScale'</span>,2.5, <span class="string">'Thickness'</span>,5};
textsize = cv.getTextSize(str, opts{:});
pt = fix(([W H] - textsize)/2);
<span class="keyword">for</span> i=0:2:254
    img = cv.putText(img - i, str, pt, <span class="keyword">...</span>
        <span class="string">'Color'</span>,[255 i i], opts{:}, lineType{:});

    set(hImg, <span class="string">'CData'</span>,img);
    pause(DELAY);
<span class="keyword">end</span></pre><img src="drawing_demo_09.png"><div class="footer">
            <p><a href="https://www.mathworks.com/products/matlab.html">Published with MATLAB&reg; R2017a</a></p>
         </div>
      </div>
      <!--
##### SOURCE BEGIN #####
%% Demonstration of drawing functions
% This program demonstrates OpenCV drawing and text output functions.
%
% Sources:
%
% * <https://github.com/opencv/opencv/blob/3.2.0/samples/cpp/drawing.cpp>
% * <https://docs.opencv.org/3.2.0/df/d61/tutorial_random_generator_and_text.html>
% * <https://docs.opencv.org/3.2.0/dc/da5/tutorial_py_drawing_functions.html>
% * <https://github.com/opencv/opencv/blob/3.2.0/samples/cpp/tutorial_code/core/Matrix/Drawing_2.cpp>
%

%% Options
DELAY = 5e-3;                  % pause delay (sec)
NUMBER = 100;                  % number of repeats
lineType = {'LineType','AA'};  % change to 8 to see non-antialiased graphics
W = 800; H = 600;              % width/height of output image
img = zeros(H,W,3,'uint8');

% rng
xlims = fix([-W/2 W*3/2]);
ylims = fix([-H/2 H*3/2]);
clr = @() randi([0 255], [1 3], 'uint8');
markers = '+x*ds^v';
marker = @() markers(randi([1 numel(markers)]));

% prepare plot
hImg = imshow(img);

%% Lines
for i=1:NUMBER*2
    pt1 = [randi(xlims) randi(ylims)];
    pt2 = [randi(xlims) randi(ylims)];
    thick = randi([1 10]);

    if rand < 0.5
        img = cv.line(img, pt1, pt2, ...
            'Color',clr(), 'Thickness',thick, lineType{:});
    else
        img = cv.arrowedLine(img, pt1, pt2, ...
            'Color',clr(), 'Thickness',thick, lineType{:});
    end

    set(hImg, 'CData',img);
    pause(DELAY);
end

%% Rectangles
for i=1:NUMBER*2
    pt1 = [randi(xlims) randi(ylims)];
    pt2 = [randi(xlims) randi(ylims)];
    thick = max(randi([-3 10]), -1);

    if rand < 0.5
        img = cv.rectangle(img, pt1, pt2, ...
            'Color',clr(), 'Thickness',thick, lineType{:});
    else
        img = cv.drawMarker(img, pt1, ...
            'Color',clr(), 'MarkerType',marker(), 'MarkerSize',randi([30 80]));
    end

    set(hImg, 'CData',img);
    pause(DELAY);
end

%% Ellipses
for i=1:NUMBER
    center = [randi(xlims) randi(ylims)];
    ax = randi([0 200], [1 2]);
    a = randi([0 180]);
    thick = randi([-1 9]);

    img = cv.ellipse(img, center, ax, ...
        'Angle',a, 'StartAngle',a-100, 'EndAngle',a+200, ...
        'Color',clr(), 'Thickness',thick, lineType{:});

    set(hImg, 'CData',img);
    pause(DELAY);
end

%% Polygons
for i=1:NUMBER
    pts = arrayfun(@(~) [randi(xlims, [3 1]) randi(ylims, [3 1])], 1:2, ...
        'Uniform',false);
    thick = randi([1 10]);

    img = cv.polylines(img, pts, ...
        'Closed',true, 'Color',clr(), 'Thickness',thick, lineType{:});

    set(hImg, 'CData',img);
    pause(DELAY);
end

%% Filled Polygons
for i=1:NUMBER
    pts = arrayfun(@(~) [randi(xlims, [3 1]) randi(ylims, [3 1])], 1:2, ...
        'Uniform',false);

    img = cv.fillPoly(img, pts, ...
        'Color',clr(), lineType{:});

    set(hImg, 'CData',img);
    pause(DELAY);
end

%% Circles
for i=1:NUMBER
    center = [randi(xlims) randi(ylims)];
    radius = randi([0 300]);
    thick = randi([-1 9]);

    img = cv.circle(img, center, radius, ...
        'Color',clr(), 'Thickness',thick, lineType{:});

    set(hImg, 'CData',img);
    pause(DELAY);
end

%% Text
str = 'Testing text rendering';
fonts = strcat('Hershey', {'Simplex', 'Plain', 'Duplex', 'Complex', ...
    'Triplex', 'ComplexSmall', 'ScriptSimplex', 'ScriptComplex'});
for i=1:NUMBER
    pt = [randi(xlims) randi(ylims)];
    font = randi([1 numel(fonts)]);
    scale = randi([0 100])*0.05 + 0.1;
    thick = randi([1 10]);

    img = cv.putText(img, str, pt, ...
        'FontFace',fonts{font}, 'FontScale',scale, ...
        'Color',clr(), 'Thickness',thick, lineType{:});

    set(hImg, 'CData',img);
    pause(DELAY);
end

%% Text Animation
str = 'OpenCV forever!';
opts = {'FontFace','HersheyComplex', 'FontScale',2.5, 'Thickness',5};
textsize = cv.getTextSize(str, opts{:});
pt = fix(([W H] - textsize)/2);
for i=0:2:254
    img = cv.putText(img - i, str, pt, ...
        'Color',[255 i i], opts{:}, lineType{:});

    set(hImg, 'CData',img);
    pause(DELAY);
end

##### SOURCE END #####
-->
   </body>
</html>