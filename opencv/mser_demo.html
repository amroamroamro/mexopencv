<!DOCTYPE html>
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <!--This HTML was auto-generated from published MATLAB code.-->
      <title>Maximally Stable Extremal Regions (MSER)</title>
      <meta name="generator" content="MATLAB 9.2">
      <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
      <meta name="DC.date" content="2017-11-27">
      <meta name="DC.source" content="mser_demo.m">
      <link rel="stylesheet" type="text/css" href="publish_custom.css">
   </head>
   <body>
      <div class="content">
         <h1 id="1">Maximally Stable Extremal Regions (MSER)</h1>
         <!--introduction-->
         <p>This program demonstrates how to use MSER to detect extremal regions.</p>
         <p>Sources:</p>
         <div>
            <ul>
               <li><a href="https://github.com/opencv/opencv/blob/3.2.0/samples/python/mser.py">https://github.com/opencv/opencv/blob/3.2.0/samples/python/mser.py</a></li>
            </ul>
         </div>
         <!--/introduction-->
         <p>open webcam</p><pre class="codeinput">cap = createVideoCapture([], <span class="string">'lena'</span>);
assert(cap.isOpened(), <span class="string">'Failed to open video capture'</span>);
img = cap.read();
assert(~isempty(img), <span class="string">'Failed to read frame'</span>);</pre><p>create MSER extractor</p><pre class="codeinput">mser = cv.MSER();</pre><p>main loop</p><pre class="codeinput">hImg = imshow(img);
<span class="keyword">while</span> ishghandle(hImg)
    <span class="comment">% read next frame</span>
    img = cap.read();
    <span class="keyword">if</span> isempty(img), <span class="keyword">break</span>; <span class="keyword">end</span>

    <span class="comment">% extract MSER regions from grayscale image</span>
    gray = cv.cvtColor(img, <span class="string">'RGB2GRAY'</span>);
    [regions, rects] = mser.detectRegions(gray);

    <span class="comment">% visualize MSER regions</span>
    <span class="keyword">for</span> i=1:numel(regions)
        <span class="comment">% draw pixel lists (using random colors)</span>
        clr = randi([0 255], [1 3]);
        img = cv.circle(img, regions{i}, 1, <span class="string">'Color'</span>,clr);
    <span class="keyword">end</span>
    <span class="keyword">if</span> true
        <span class="comment">% compute convex hulls and draw them</span>
        hulls = cellfun(@(r) cv.convexHull(r), regions, <span class="string">'UniformOutput'</span>,false);
        img = cv.polylines(img, hulls, <span class="string">'Closed'</span>,true, <span class="string">'Color'</span>,[0 255 0]);
    <span class="keyword">else</span>
        <span class="comment">% fit ellipses and draw them</span>
        rrects = cellfun(@(r) cv.fitEllipse(r), regions);
        img = cv.ellipse(img, rrects, <span class="string">'Color'</span>,[0 255 0]);
    <span class="keyword">end</span>
    <span class="keyword">if</span> false
        <span class="comment">% draw bounding boxes</span>
        img = cv.rectangle(img, rects, <span class="string">'Color'</span>,[255 0 255]);
    <span class="keyword">end</span>

    <span class="comment">% show result</span>
    set(hImg, <span class="string">'CData'</span>,img);
    drawnow;
<span class="keyword">end</span></pre><img src="mser_demo_01.png"><p>close webcam</p><pre class="codeinput">cap.release();</pre><div class="footer">
            <p><a href="https://www.mathworks.com/products/matlab.html">Published with MATLAB&reg; R2017a</a></p>
         </div>
      </div>
      <!--
##### SOURCE BEGIN #####
%% Maximally Stable Extremal Regions (MSER)
% This program demonstrates how to use MSER to detect extremal regions.
%
% Sources:
%
% * <https://github.com/opencv/opencv/blob/3.2.0/samples/python/mser.py>
%

%%
% open webcam
cap = createVideoCapture([], 'lena');
assert(cap.isOpened(), 'Failed to open video capture');
img = cap.read();
assert(~isempty(img), 'Failed to read frame');

%%
% create MSER extractor
mser = cv.MSER();

%%
% main loop
hImg = imshow(img);
while ishghandle(hImg)
    % read next frame
    img = cap.read();
    if isempty(img), break; end

    % extract MSER regions from grayscale image
    gray = cv.cvtColor(img, 'RGB2GRAY');
    [regions, rects] = mser.detectRegions(gray);

    % visualize MSER regions
    for i=1:numel(regions)
        % draw pixel lists (using random colors)
        clr = randi([0 255], [1 3]);
        img = cv.circle(img, regions{i}, 1, 'Color',clr);
    end
    if true
        % compute convex hulls and draw them
        hulls = cellfun(@(r) cv.convexHull(r), regions, 'UniformOutput',false);
        img = cv.polylines(img, hulls, 'Closed',true, 'Color',[0 255 0]);
    else
        % fit ellipses and draw them
        rrects = cellfun(@(r) cv.fitEllipse(r), regions);
        img = cv.ellipse(img, rrects, 'Color',[0 255 0]);
    end
    if false
        % draw bounding boxes
        img = cv.rectangle(img, rects, 'Color',[255 0 255]);
    end

    % show result
    set(hImg, 'CData',img);
    drawnow;
end

%%
% close webcam
cap.release();

##### SOURCE END #####
-->
   </body>
</html>